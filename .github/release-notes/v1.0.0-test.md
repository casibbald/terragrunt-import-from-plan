# .github/release-notes/v1.0.0-test.md

## âœ¨ Terragrunt Import from Plan v1.0.0-test

This release introduces a GitHub Action that automates the import of resources detected in a `terragrunt plan` into the Terraform state.

### ğŸš€ Features

- ğŸ” Parses `terraform show -json` output from `tf.plan`
- ğŸ“¦ Dynamically identifies resources with `create`, `create+update`, or `replace` actions
- ğŸ”‘ Extracts importable IDs from fields like `repository_id`, `name`, `bucket`, `id`, `arn`, or full Azure resource IDs
- ğŸ›  Supports optional cloud-specific ID formatting:
  - **GCP**: prefix `projects/$PROJECT_ID/locations/$LOCATION/repositories/...`
  - **AWS**: uses raw `arn:` strings when detected (e.g., `arn:aws:iam::...:role/...`)
  - **Azure**: uses full `/subscriptions/...` IDs directly (e.g., `/subscriptions/.../resourceGroups/...`)
- ğŸ“Š Outputs a summary of:
  - Imported resources
  - Already in state
  - Skipped (due to missing ID)

### ğŸ§ª Included Test Suite

Run `./test/entrypoint_test.sh` to validate logic with mocked input â€” no infrastructure required.

---

### ğŸ“¦ Installation

```yaml
- name: Import from plan
  uses: casibbald/terragrunt-import-from-plan@v1
  with:
    working-directory: ./your/module/path
```

Set cloud-specific environment variables if your IDs require full context:

#### For GCP:
```yaml
env:
  PROJECT_ID: your-project-id
  LOCATION: your-location
```

#### For AWS or Azure:
If your resources use `arn:` or `/subscriptions/...`, no additional variables are needed â€” the action detects and imports using them directly.

---

### ğŸ“„ Example Plan JSON Snippets

#### GCP Artifact Registry
```json
{
  "address": "google_artifact_registry_repository.remote[\"foo\"]",
  "change": {
    "actions": ["create"],
    "after": {
      "repository_id": "foo"
    }
  }
}
```

#### AWS IAM Role
```json
{
  "address": "aws_iam_role.role[\"app\"]",
  "change": {
    "actions": ["create"],
    "after": {
      "arn": "arn:aws:iam::123456789012:role/app"
    }
  }
}
```

#### Azure Storage Account
```json
{
  "address": "azurerm_storage_account.example[\"main\"]",
  "change": {
    "actions": ["create"],
    "after": {
      "id": "/subscriptions/0000-1111-2222-3333/resourceGroups/rg/providers/Microsoft.Storage/storageAccounts/myaccount"
    }
  }
}
```
